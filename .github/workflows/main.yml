# .github/workflows/main.yml

name: DNF Daily Check-in

on:
  # 1. 定时触发：使用 Cron 语法，在北京时间每天早上 9:30 运行
  #    Cron 的时间是 UTC 时间，'30 1 * * *' 对应 UTC 1:30 AM，即北京时间 9:30 AM
  schedule:
    - cron: '0 18 * * *'

  # 2. 手动触发：允许您在 Actions 页面手动点击 "Run workflow" 来运行
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest # 使用最新的 Ubuntu 虚拟机环境

    steps:
      # 第一步：检出（下载）您的代码到虚拟机
      - name: Checkout repository
        uses: actions/checkout@v4

      # 第二步：设置 Node.js 环境
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # 指定 Node.js 版本

      # 第三步：运行您的脚本
      - name: Run DNF Fetch Script
        # 关键：在这里将您设置的 GitHub Secret 注入到环境变量中
        env:
          DNF_COOKIE: ${{ secrets.DNF_COOKIE }}
        run: node DNF_FETCH.JS